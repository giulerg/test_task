1)
select * from items  
join ( select item_id, max(update_date) as update_date 
  from items
  WHERE update_date >= '2020-06-01'
  group by item_id) as actual 
on items.item_id = actual.item_id 
and items.update_date = actual.update_date


2)
select * from items  
join  (
  select item_id, max(update_date) as update_date 
  from items
  WHERE price >= 3
  group by item_id
) as actual 
on items.item_id = actual.item_id 
and items.update_date = actual.update_date

3)
select 
  sum(price) 
from 
  (
    select 
      items.item_id, items.name,  items.price, items.update_date, orders.order_date, 
      ROW_NUMBER() over (
        partition by items.item_id,  order_id order by update_date desc) as n, 
      orders.order_id 
    from 
      items 
      join orders on items.item_id = orders.item_id 
    where user_id = 1 and order_date >= update_date
  ) 
where n = 1

4)
select 
  sum(price) 
from 
  (
    select 
      items.item_id, items.name,  items.price, items.update_date, orders.order_date, 
      ROW_NUMBER() over (
        partition by items.item_id,  order_id order by update_date desc) as n, 
      orders.order_id 
    from 
      items 
      join orders on items.item_id = orders.item_id 
    where  order_date<='2020-05-01' and order_date >= update_date
  ) 
where n = 1

5)
select 
   EXTRACT(quarter from order_date   ) as quarter, 
   FLOOR(avg(price))  as avg_price,
   sum(price) as sum_price
from 
  (
    select 
       items.price,   orders.order_date, 
      ROW_NUMBER() over (
        partition by items.item_id,  order_id order by update_date desc) as n 
    from 
      items 
      join orders on items.item_id = orders.item_id 
    where  order_date >= update_date
  ) 
where n = 1
group by quarter

